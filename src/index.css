/* Tailwind core layers MUST come first and in this order */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* =========================
   Design tokens (CSS vars)
   ========================= */
@layer base {
  :root {
    --brand-500: #046BD9;
    --brand-400: #5aa8f2;

    --app-bg:       #f7f8fb;
    --app-surface:  #ffffff;
    --app-muted:    #f1f3f7;
    --app-border:   #e5e7eb;
    --app-strong:   #111827;
    --app-body:     #334155;
    --app-mutedText:#64748b;

    --r-sm: 8px;
    --r-md: 12px;
    --r-lg: 16px;

    --sh-sm: 0 1px 2px rgba(17,24,39,0.06);
    --sh-card: 0 6px 16px rgba(17,24,39,0.08);
    --sh-lg: 0 12px 30px rgba(17,24,39,0.12);
  }

  html, body, #root { height: 100%; }

  body {
    background: var(--app-bg);
    color: var(--app-body);
    @apply font-sans antialiased;
    line-height: 1.6;
  }

  :focus-visible {
    outline: 2px solid var(--brand-500);
    outline-offset: 2px;
    border-radius: 6px;
  }
}

/* =========================
   Helpers (put in components layer to avoid the warning)
   ========================= */
@layer components {
  /* Layout helpers */
  .container-tight { @apply container max-w-[1400px]; }
  .app-shell { @apply grid min-h-full grid-rows-[auto_1fr]; }
  .app-main { @apply grid gap-4 p-4 lg:grid-cols-[360px_1fr]; }

  /* Color utilities (CSS vars) */
  .text-app-strong { color: var(--app-strong); }
  .text-app-body { color: var(--app-body); }
  .text-app-muted { color: var(--app-mutedText); }
  .bg-app-surface { background: var(--app-surface); }
  .bg-app-muted { background: var(--app-muted); }
  .border-app { border-color: var(--app-border); }

  /* Panels & Cards */
  .panel {
    background: var(--app-surface);
    border: 1px solid var(--app-border);
    border-radius: var(--r-lg);
    box-shadow: var(--sh-sm);
  }
  .panel-header {
    @apply flex items-center justify-between px-4 py-3;
    border-bottom: 1px solid var(--app-border);
    background: #fff;
  }
  .card {
    background: var(--app-surface);
    border: 1px solid var(--app-border);
    border-radius: var(--r-lg);
    box-shadow: var(--sh-card);
  }
  .card--accent { border-left: 4px solid var(--brand-500); }
  .card-header { @apply px-4 py-3 font-semibold; color: var(--app-strong); border-bottom: 1px solid var(--app-border); }
  .card-body { @apply p-4; }

  /* Buttons */
  .btn {
    @apply inline-flex items-center justify-center gap-2 h-9 px-3.5 text-sm font-semibold transition duration-200;
    color: #fff;
    background: var(--brand-500);
    border: 1px solid transparent;
    border-radius: var(--r-sm);
    box-shadow: var(--sh-sm);
  }
  .btn:hover { box-shadow: var(--sh-card); }
  .btn:active { transform: translateY(1px); }
  .btn-outline {
    @apply inline-flex items-center justify-center gap-2 h-9 px-3 text-sm font-semibold transition duration-200;
    color: var(--app-strong);
    background: transparent;
    border: 1px solid var(--app-border);
    border-radius: var(--r-sm);
  }
  .btn-outline:hover { background: var(--app-muted); }
  .btn-accent {
    color: #fff;
    background: var(--brand-400);
    border-radius: var(--r-sm);
    box-shadow: var(--sh-sm);
  }
  .chip {
    @apply inline-flex items-center gap-1.5 h-7 px-2.5 text-xs font-semibold transition duration-150;
    color: var(--app-body);
    background: #fff;
    border: 1px solid var(--app-border);
    border-radius: 999px;
  }
  .chip:hover { background: var(--app-muted); }

  /* Inputs */
  .input, .select, .textarea {
    @apply w-full transition duration-150;
    background: #fff;
    color: var(--app-body);
    border: 1px solid var(--app-border);
    border-radius: var(--r-sm);
    box-shadow: var(--sh-sm);
  }
  .input, .select { @apply h-9 px-3 text-sm; }
  .textarea { @apply px-3 py-2 text-sm; min-height: 120px; resize: vertical; }
  .input::placeholder, .textarea::placeholder { color: #9aa5b1; }
  .input:focus, .select:focus, .textarea:focus {
    border-color: color-mix(in oklab, var(--brand-500), white 25%);
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--brand-500), white 70%);
    outline: none;
  }

  /* Top bar & Tabs */
  .topbar {
    @apply sticky top-0 z-30 border-b;
    background: rgba(255,255,255,.9);
    backdrop-filter: saturate(150%) blur(8px);
    border-color: var(--app-border);
  }
  .tabset { @apply inline-flex p-1 rounded-full; background: var(--app-muted); }
  .tabset-btn {
    @apply min-w-[90px] h-8 px-3 rounded-full border-0 font-semibold transition duration-150;
    color: var(--app-mutedText);
    background: transparent;
  }
  .tabset-btn[data-active="true"] {
    color: var(--app-strong);
    background: #fff;
    box-shadow: var(--sh-sm);
  }

  /* Preview polish */
  .preview-frame {
    background: #fff;
    border: 1px solid var(--app-border);
    border-radius: var(--r-lg);
    box-shadow: var(--sh-card);
    overflow: hidden;
  }
  .preview-header { @apply flex items-center gap-3 px-4 py-3; border-bottom: 1px solid var(--app-border); }
  .carousel-arrow {
    @apply absolute top-1/2 -translate-y-1/2 grid place-items-center h-8 w-8 transition duration-150;
    background: rgba(255,255,255,.9);
    border: 1px solid var(--app-border);
    border-radius: 999px;
    box-shadow: var(--sh-sm);
    cursor: pointer;
  }
  .carousel-arrow:hover { background: #fff; box-shadow: var(--sh-card); }
  .carousel-arrow--left { left: 10px; }
  .carousel-arrow--right { right: 10px; }

  /* Glassmorphism */
  .glass {
    background: linear-gradient(to bottom right, rgba(255,255,255,.65), rgba(255,255,255,.45));
    border: 1px solid rgba(255,255,255,.6);
    border-radius: var(--r-lg);
    box-shadow: var(--sh-card);
    backdrop-filter: blur(10px) saturate(140%);
  }

  /* Typography helpers */
  .h1 { color: var(--app-strong); font-weight: 700; font-size: clamp(24px, 3.2vw, 32px); line-height: 1.25; }
  .h2 { color: var(--app-strong); font-weight: 600; font-size: clamp(20px, 2.6vw, 24px); line-height: 1.30; }
  .h3 { color: var(--app-strong); font-weight: 600; font-size: clamp(18px, 2.2vw, 20px); line-height: 1.35; }
  .lead { color: var(--app-body); font-size: 1.05rem; }
  .muted { color: var(--app-mutedText); }

  /* Spacing stacks */
  .stack-sm > * + * { margin-top: 8px; }
  .stack-md > * + * { margin-top: 12px; }
  .stack-lg > * + * { margin-top: 16px; }
}

/* Mobile tweaks */
@media (max-width: 768px) {
  .panel-header { padding: 10px 12px; }
  .card-body { padding: 12px; }
  .btn, .btn-outline { height: 34px; padding: 0 12px; }
}
