import{r as n,e as h,s as v,j as s,R as j}from"./index-Di380nSE.js";function b({token:i}){const[d,x]=n.useState(!0),[m,f]=n.useState(""),[u,g]=n.useState(null),[e,p]=n.useState([]),[l,a]=n.useState(0),w=n.useMemo(()=>e[l]?h(e[l]):h({}),[e,l]),o=n.useCallback(()=>a(t=>e.length?(t-1+e.length)%e.length:0),[e.length]),c=n.useCallback(()=>a(t=>e.length?(t+1)%e.length:0),[e.length]);return n.useEffect(()=>{(async()=>{try{x(!0);const{data:t,error:r}=await v.rpc("get_deck_share",{p_token:i});if(r)throw r;if(t?.error)throw new Error(String(t.error));g(t.deck),p((t.items||[]).map(k=>k.post_json)),a(0)}catch(t){console.error(t);const r=t.message||"Error";f(r==="not_found"?"Link not found":r==="revoked"?"Link was revoked":r==="expired"?"Link expired":"Could not load this deck")}finally{x(!1)}})()},[i]),n.useEffect(()=>{const t=r=>{e.length&&(r.key==="ArrowLeft"&&o(),r.key==="ArrowRight"&&c())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e.length,o,c]),s.jsxs("div",{className:"min-h-screen flex flex-col items-center bg-[var(--bg)] p-4",children:[s.jsxs("div",{className:"w-full max-w-screen-lg flex items-center justify-between mb-3",children:[s.jsx("div",{className:"font-medium",children:u?u.title:"Deck"}),s.jsx("div",{className:"text-app-muted text-sm",children:e.length?`${l+1} / ${e.length}`:d?"Loading...":""})]}),s.jsx("div",{className:"w-full max-w-screen-lg flex-1 min-h-0 flex items-start justify-center",children:d?s.jsx("div",{className:"card p-8 text-center w-full",children:"Loading..."}):m?s.jsx("div",{className:"card p-8 text-center text-red-600 w-full",children:m}):e.length===0?s.jsx("div",{className:"card p-8 text-center text-app-muted w-full",children:"No posts in this deck"}):s.jsx(j,{post:w,setPost:()=>{},mode:"present",clamp:{maxVmin:68,maxPx:560},showExport:!1})}),e.length>1?s.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[s.jsx("button",{className:"btn-outline",onClick:o,children:"Prev"}),s.jsx("button",{className:"btn",onClick:c,children:"Next"})]}):null]})}export{b as default};
